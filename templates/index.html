{% extends "base.html" %}

{% block title %}AI Life Coach - Your Personal Mentor{% endblock %}

{% block content %}
<div class="row">
    <!-- Chat Interface -->
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">
                    <i class="fas fa-comments me-2"></i>
                    Life Coaching Session
                </h5>
                <div class="d-flex gap-2">
                    <button class="btn btn-sm btn-outline-secondary" onclick="clearChat()" title="Clear Chat">
                        <i class="fas fa-eraser"></i>
                    </button>
                    <button class="btn btn-sm btn-outline-info" onclick="showMemory()" title="View Progress">
                        <i class="fas fa-chart-line"></i>
                    </button>
                </div>
            </div>
            <div class="card-body">
                <!-- Chat Messages -->
                <div id="chat-messages" class="chat-container mb-3">
                    <div class="message assistant-message">
                        <div class="message-content">
                            <i class="fas fa-brain me-2"></i>
                            <strong>AI Coach:</strong> Hello! I'm your personal life coach. Share what's on your mind, tell me about your day, your goals, or any challenges you're facing. I'm here to provide personalized guidance based on our conversation history.
                        </div>
                    </div>
                </div>
                
                <!-- Input Form -->
                <form id="chat-form" class="d-flex gap-2">
                    <div class="flex-grow-1">
                        <textarea 
                            id="message-input" 
                            class="form-control" 
                            rows="3" 
                            placeholder="Share what's on your mind... (e.g., 'I'm feeling overwhelmed at work' or 'I want to start exercising regularly')"
                            required></textarea>
                    </div>
                    <div class="d-flex flex-column gap-2">
                        <button type="submit" class="btn btn-primary" id="send-btn">
                            <i class="fas fa-paper-plane"></i>
                            Send
                        </button>
                        <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addGoal()" title="Add Goal">
                            <i class="fas fa-target"></i>
                        </button>
                    </div>
                </form>
                
                <!-- Loading indicator -->
                <div id="loading" class="text-center mt-3" style="display: none;">
                    <div class="spinner-border spinner-border-sm me-2" role="status"></div>
                    <span>Your coach is thinking...</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Sidebar -->
    <div class="col-lg-4">
        <!-- Quick Actions -->
        <div class="card mb-4">
            <div class="card-header">
                <h6 class="card-title mb-0">
                    <i class="fas fa-bolt me-2"></i>
                    Quick Actions
                </h6>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <button class="btn btn-outline-primary btn-sm" onclick="sendQuickMessage('How can I be more productive today?')">
                        <i class="fas fa-rocket me-1"></i>
                        Productivity Tips
                    </button>
                    <button class="btn btn-outline-success btn-sm" onclick="sendQuickMessage('Help me review my goals and progress')">
                        <i class="fas fa-target me-1"></i>
                        Review Goals
                    </button>
                    <button class="btn btn-outline-info btn-sm" onclick="sendQuickMessage('I want to reflect on my recent experiences')">
                        <i class="fas fa-mirror me-1"></i>
                        Life Reflection
                    </button>
                    <button class="btn btn-outline-warning btn-sm" onclick="sendQuickMessage('I need motivation and encouragement')">
                        <i class="fas fa-heart me-1"></i>
                        Motivation Boost
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Memory Overview -->
        <div class="card">
            <div class="card-header">
                <h6 class="card-title mb-0">
                    <i class="fas fa-brain me-2"></i>
                    Your Journey
                </h6>
            </div>
            <div class="card-body">
                <div id="memory-overview">
                    <div class="text-center text-muted">
                        <i class="fas fa-spinner fa-spin"></i>
                        <br>Loading your progress...
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Goal Modal -->
<div class="modal fade" id="goalModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-target me-2"></i>
                    Add New Goal
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="goal-form">
                    <div class="mb-3">
                        <label for="goal-text" class="form-label">Goal Description</label>
                        <textarea class="form-control" id="goal-text" rows="3" placeholder="Describe your goal..." required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="target-date" class="form-label">Target Date (Optional)</label>
                        <input type="date" class="form-control" id="target-date">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveGoal()">Add Goal</button>
            </div>
        </div>
    </div>
</div>

<!-- Memory Modal -->
<div class="modal fade" id="memoryModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-chart-line me-2"></i>
                    Your Progress & Insights
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="memory-details">
                    <div class="text-center">
                        <div class="spinner-border" role="status"></div>
                        <p class="mt-2">Loading your journey details...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
